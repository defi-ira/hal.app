(self.webpackChunkzurik=self.webpackChunkzurik||[]).push([[658],{7658:(I,A,b)=>{"use strict";b.r(A),b.d(A,{AlchemyWebSocketProvider:()=>ye});var c=b(4066),S=b(3488),O=b(2909),R=b(2492),y=b(4325),P=b(1210),v=b(8666),a=b(9802);let i=null;try{if(i=WebSocket,null==i)throw new Error("inject please")}catch{const e=new v.Yd(a.i);i=function(){e.throwError("WebSockets not supported in this environment",v.Yd.errors.UNSUPPORTED_OPERATION,{operation:"new WebSocket()"})}}var u=function(r,e,t,s){return new(t||(t=Promise))(function(o,l){function h(k){try{p(s.next(k))}catch(g){l(g)}}function f(k){try{p(s.throw(k))}catch(g){l(g)}}function p(k){k.done?o(k.value):function n(o){return o instanceof t?o:new t(function(l){l(o)})}(k.value).then(h,f)}p((s=s.apply(r,e||[])).next())})};const d=new v.Yd(a.i);let w=1;class N extends P.r{constructor(e,t){"any"===t&&d.throwError("WebSocketProvider does not support 'any' network yet",v.Yd.errors.UNSUPPORTED_OPERATION,{operation:"network:any"}),super("string"==typeof e?e:"_websocket",t),this._pollingInterval=-1,this._wsReady=!1,(0,y.zG)(this,"_websocket","string"==typeof e?new i(this.connection.url):e),(0,y.zG)(this,"_requests",{}),(0,y.zG)(this,"_subs",{}),(0,y.zG)(this,"_subIds",{}),(0,y.zG)(this,"_detectNetwork",super.detectNetwork()),this.websocket.onopen=()=>{this._wsReady=!0,Object.keys(this._requests).forEach(n=>{this.websocket.send(this._requests[n].payload)})},this.websocket.onmessage=n=>{const o=n.data,l=JSON.parse(o);if(null!=l.id){const h=String(l.id),f=this._requests[h];if(delete this._requests[h],void 0!==l.result)f.callback(null,l.result),this.emit("debug",{action:"response",request:JSON.parse(f.payload),response:l.result,provider:this});else{let p=null;l.error?(p=new Error(l.error.message||"unknown error"),(0,y.zG)(p,"code",l.error.code||null),(0,y.zG)(p,"response",o)):p=new Error("unknown error"),f.callback(p,void 0),this.emit("debug",{action:"response",error:p,request:JSON.parse(f.payload),provider:this})}}else if("eth_subscription"===l.method){const h=this._subs[l.params.subscription];h&&h.processFunc(l.params.result)}else console.warn("this should not happen")};const s=setInterval(()=>{this.emit("poll")},1e3);s.unref&&s.unref()}get websocket(){return this._websocket}detectNetwork(){return this._detectNetwork}get pollingInterval(){return 0}resetEventsBlock(e){d.throwError("cannot reset events block on WebSocketProvider",v.Yd.errors.UNSUPPORTED_OPERATION,{operation:"resetEventBlock"})}set pollingInterval(e){d.throwError("cannot set polling interval on WebSocketProvider",v.Yd.errors.UNSUPPORTED_OPERATION,{operation:"setPollingInterval"})}poll(){return u(this,void 0,void 0,function*(){return null})}set polling(e){!e||d.throwError("cannot set polling on WebSocketProvider",v.Yd.errors.UNSUPPORTED_OPERATION,{operation:"setPolling"})}send(e,t){const s=w++;return new Promise((n,o)=>{const h=JSON.stringify({method:e,params:t,id:s,jsonrpc:"2.0"});this.emit("debug",{action:"request",request:JSON.parse(h),provider:this}),this._requests[String(s)]={callback:function l(f,p){return f?o(f):n(p)},payload:h},this._wsReady&&this.websocket.send(h)})}static defaultUrl(){return"ws://localhost:8546"}_subscribe(e,t,s){return u(this,void 0,void 0,function*(){let n=this._subIds[e];null==n&&(n=Promise.all(t).then(l=>this.send("eth_subscribe",l)),this._subIds[e]=n);const o=yield n;this._subs[o]={tag:e,processFunc:s}})}_startEvent(e){switch(e.type){case"block":this._subscribe("block",["newHeads"],t=>{const s=O.O$.from(t.number).toNumber();this._emitted.block=s,this.emit("block",s)});break;case"pending":this._subscribe("pending",["newPendingTransactions"],t=>{this.emit("pending",t)});break;case"filter":this._subscribe(e.tag,["logs",this._getFilter(e.filter)],t=>{null==t.removed&&(t.removed=!1),this.emit(e.filter,this.formatter.filterLog(t))});break;case"tx":{const t=s=>{const n=s.hash;this.getTransactionReceipt(n).then(o=>{!o||this.emit(n,o)})};t(e),this._subscribe("tx",["newHeads"],s=>{this._events.filter(n=>"tx"===n.type).forEach(t)});break}case"debug":case"poll":case"willPoll":case"didPoll":case"error":break;default:console.log("unhandled:",e)}}_stopEvent(e){let t=e.tag;if("tx"===e.type){if(this._events.filter(n=>"tx"===n.type).length)return;t="tx"}else if(this.listenerCount(e.event))return;const s=this._subIds[t];!s||(delete this._subIds[t],s.then(n=>{!this._subs[n]||(delete this._subs[n],this.send("eth_unsubscribe",[n]))}))}destroy(){return u(this,void 0,void 0,function*(){this.websocket.readyState===i.CONNECTING&&(yield new Promise(e=>{this.websocket.onopen=function(){e(!0)},this.websocket.onerror=function(){e(!1)}})),this.websocket.close(1e3)})}}var m=b(4595);b(6659);const L="alchemy-pending-transactions",x="alchemy-mined-transactions",W=[L,x];class ne extends class se{constructor(e,t,s){this.listener=t,this.tag=e,this.once=s,this._lastBlockNumber=-2,this._inflight=!1}get event(){switch(this.type){case"tx":return this.hash;case"filter":return this.filter;default:return this.tag}}get type(){return this.tag.split(":")[0]}get hash(){const e=this.tag.split(":");if("tx"!==e[0])throw new Error("Not a transaction event");return e[1]}get filter(){const e=this.tag.split(":");if("filter"!==e[0])throw new Error("Not a transaction event");const t=e[1],s=function ce(r){return""===r?[]:r.split(/&/g).map(e=>{if(""===e)return[];const t=e.split("|").map(s=>"null"===s?null:s);return 1===t.length?t[0]:t})}(e[2]),n={};return s.length>0&&(n.topics=s),t&&"*"!==t&&(n.address=t),n}pollable(){return this.tag.indexOf(":")>=0||["block","network","pending","poll"].indexOf(this.tag)>=0}}{get fromAddress(){const e=this.tag.split(":");if(e[0]===L&&e[1]&&"*"!==e[1])return X(e[1])}get toAddress(){const e=this.tag.split(":");if(e[0]===L&&e[2]&&"*"!==e[2])return X(e[2])}get hashesOnly(){const e=this.tag.split(":");if(W.includes(e[0])&&e[3]&&"*"!==e[3])return"true"===e[3]}get includeRemoved(){const e=this.tag.split(":");if(e[0]===x&&e[2]&&"*"!==e[2])return"true"===e[2]}get addresses(){const e=this.tag.split(":");if(e[0]===x&&e[1]&&"*"!==e[1])return function ue(r){if(""!==r)return r.split("|").map(e=>e.split(",")).map(e=>Object.assign(Object.assign({},"*"!==e[0]&&{to:e[0]}),"*"!==e[1]&&{from:e[1]}))}(e[1])}}function B(r){return"object"==typeof r&&"method"in r}function H(r){if(!B(r))throw new Error("Event tag requires AlchemyEventType");if(r.method===c.A.PENDING_TRANSACTIONS)return function ie(r){const e=D(r.fromAddress),t=D(r.toAddress),s=z(r.hashesOnly);return L+":"+e+":"+t+":"+s}(r);if(r.method===c.A.MINED_TRANSACTIONS)return function oe(r){const e=function le(r){return void 0===r?"*":r.map(e=>D(e.to)+","+D(e.from)).join("|")}(r.addresses),t=z(r.includeRemoved),s=z(r.hashesOnly);return x+":"+e+":"+t+":"+s}(r);throw new Error(`Unrecognized AlchemyFilterEvent: ${r}`)}function D(r){return void 0===r?"*":Array.isArray(r)?r.join("|"):r}function z(r){return void 0===r?"*":r.toString()}function X(r){if(""===r)return;const e=r.split("|");return 1===e.length?e[0]:e}class he{constructor(e){this.provider=e,this.maxBackfillBlocks=120}getNewHeadsBackfill(e,t,s){return(0,c._)(this,void 0,void 0,function*(){_(e);const n=yield this.getBlockNumber();if(_(e),0===t.length)return this.getHeadEventsInRange(Math.max(s,n-this.maxBackfillBlocks)+1,n+1);const o=(0,c.f)(t[t.length-1].number),l=n-this.maxBackfillBlocks+1;if(o<=l)return this.getHeadEventsInRange(l,n+1);const h=yield this.getReorgHeads(e,t);_(e);const f=yield this.getHeadEventsInRange(o+1,n+1);return _(e),[...h,...f]})}getLogsBackfill(e,t,s,n){return(0,c._)(this,void 0,void 0,function*(){_(e);const o=yield this.getBlockNumber();if(_(e),0===s.length)return this.getLogsInRange(t,Math.max(n,o-this.maxBackfillBlocks)+1,o+1);const l=(0,c.f)(s[s.length-1].blockNumber),h=o-this.maxBackfillBlocks+1;if(l<h)return this.getLogsInRange(t,h,o+1);const f=yield this.getCommonAncestor(e,s);_(e);const p=s.filter(E=>(0,c.f)(E.blockNumber)>f.blockNumber).map(E=>Object.assign(Object.assign({},E),{removed:!0})),k=f.blockNumber===Number.NEGATIVE_INFINITY?(0,c.f)(s[0].blockNumber):f.blockNumber;let g=yield this.getLogsInRange(t,k,o+1);return g=g.filter(E=>E&&((0,c.f)(E.blockNumber)>f.blockNumber||(0,c.f)(E.logIndex)>f.logIndex)),_(e),[...p,...g]})}setMaxBackfillBlock(e){this.maxBackfillBlocks=e}getBlockNumber(){return(0,c._)(this,void 0,void 0,function*(){const e=yield this.provider.send("eth_blockNumber");return(0,c.f)(e)})}getHeadEventsInRange(e,t){return(0,c._)(this,void 0,void 0,function*(){if(e>=t)return[];const s=[];for(let l=e;l<t;l++)s.push({method:"eth_getBlockByNumber",params:[(0,c.t)(l),!1]});return(yield this.provider.sendBatch(s)).reduce((l,h)=>l.concat(h),[]).map(Z)})}getReorgHeads(e,t){return(0,c._)(this,void 0,void 0,function*(){const s=[];for(let n=t.length-1;n>=0;n--){const o=t[n],l=yield this.getBlockByNumber((0,c.f)(o.number));if(_(e),o.hash===l.hash)break;s.push(Z(l))}return s.reverse()})}getBlockByNumber(e){return(0,c._)(this,void 0,void 0,function*(){return this.provider.send("eth_getBlockByNumber",[(0,c.t)(e),!1])})}getCommonAncestor(e,t){return(0,c._)(this,void 0,void 0,function*(){let s=yield this.getBlockByNumber((0,c.f)(t[t.length-1].blockNumber));_(e);for(let n=t.length-1;n>=0;n--){const o=t[n];if(o.blockNumber!==s.number&&(s=yield this.getBlockByNumber((0,c.f)(o.blockNumber))),o.blockHash===s.hash)return{blockNumber:(0,c.f)(o.blockNumber),logIndex:(0,c.f)(o.logIndex)}}return{blockNumber:Number.NEGATIVE_INFINITY,logIndex:Number.NEGATIVE_INFINITY}})}getLogsInRange(e,t,s){return(0,c._)(this,void 0,void 0,function*(){if(t>=s)return[];const n=Object.assign(Object.assign({},e),{fromBlock:(0,c.t)(t),toBlock:(0,c.t)(s-1)});return this.provider.send("eth_getLogs",[n])})}}function Z(r){const e=Object.assign({},r);return delete e.totalDifficulty,delete e.transactions,delete e.uncles,e}function Q(r,e){const t=new Set,s=[];return r.forEach(n=>{const o=e(n);t.has(o)||(t.add(o),s.push(n))}),s}const be=new Error("Cancelled");function _(r){if(r())throw be}class ye extends N{constructor(e,t){var s;const n=m.AlchemyProvider.getApiKey(e.apiKey),o=m.AlchemyProvider.getAlchemyNetwork(e.network),l=m.AlchemyProvider.getAlchemyConnectionInfo(o,n,"wss");super(new S.Z(null!==(s=e.url)&&void 0!==s?s:l.url,`alchemy-sdk-${c.V}`,{wsConstructor:t??(typeof process<"u"&&null!=process&&null!=process.versions&&null!=process.versions.node?b(2762).w3cwebsocket:WebSocket)}),c.E[o]),this._events=[],this.virtualSubscriptionsById=new Map,this.virtualIdsByPhysicalId=new Map,this.handleMessage=k=>{const g=JSON.parse(k.data);if(!function Ae(r){return!function Ie(r){return Array.isArray(r)||"2.0"===r.jsonrpc&&void 0!==r.id}(r)}(g))return;const E=g.params.subscription,T=this.virtualIdsByPhysicalId.get(E);if(!T)return;const G=this.virtualSubscriptionsById.get(T);if("eth_subscribe"===G.method)switch(G.params[0]){case"newHeads":{const K=G,V=g,{isBackfilling:$,backfillBuffer:J}=K,{result:C}=V.params;$?function Se(r,e){U(r,e,M)}(J,C):E!==T?this.emitAndRememberEvent(T,C,M):this.rememberEvent(T,C,M);break}case"logs":{const K=G,V=g,{isBackfilling:$,backfillBuffer:J}=K,{result:C}=V.params;$?function Oe(r,e){U(r,e,j)}(J,C):T!==E?this.emitAndRememberEvent(T,C,j):this.rememberEvent(T,C,j);break}}},this.handleReopen=()=>{this.virtualIdsByPhysicalId.clear();const{cancel:k,isCancelled:g}=function ve(){let r=!1;return{cancel:()=>r=!0,isCancelled:()=>r}}();this.cancelBackfill=k;for(const E of this.virtualSubscriptionsById.values())(0,c._)(this,void 0,void 0,function*(){try{yield this.resubscribeAndBackfill(g,E)}catch(T){g()||console.error(`Error while backfilling "${E.params[0]}" subscription. Some events may be missing.`,T)}});this.startHeartbeat()},this.stopHeartbeatAndBackfill=()=>{null!=this.heartbeatIntervalId&&(clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=void 0),this.cancelBackfill()},this.apiKey=n,this.backfiller=new he(this),this.addSocketListeners(),this.startHeartbeat(),this.cancelBackfill=c.n}static getNetwork(e){return"string"==typeof e&&e in c.C?c.C[e]:(0,R.H)(e)}on(e,t){return this._addEventListener(e,t,!1)}once(e,t){return this._addEventListener(e,t,!0)}off(e,t){return B(e)?this._off(e,t):super.off(e,t)}removeAllListeners(e){return void 0!==e&&B(e)?this._removeAllListeners(e):super.removeAllListeners(e)}listenerCount(e){return void 0!==e&&B(e)?this._listenerCount(e):super.listenerCount(e)}listeners(e){return void 0!==e&&B(e)?this._listeners(e):super.listeners(e)}_addEventListener(e,t,s){if(B(e)){!function re(r){if(!Object.values(c.A).includes(r.method))throw new Error(`Invalid method name ${r.method}. Accepted method names: ${Object.values(c.A)}`)}(e);const n=new ne(H(e),t,s);return this._events.push(n),this._startEvent(n),this}return super._addEventListener(e,t,s)}_startEvent(e){[...W,"block","filter"].includes(e.type)?this.customStartEvent(e):super._startEvent(e)}_subscribe(e,t,s,n){return(0,c._)(this,void 0,void 0,function*(){let o=this._subIds[e];const l=yield this.getBlockNumber();null==o&&(o=Promise.all(t).then(p=>this.send("eth_subscribe",p)),this._subIds[e]=o);const h=yield o,f=yield Promise.all(t);this.virtualSubscriptionsById.set(h,{event:n,method:"eth_subscribe",params:f,startingBlockNumber:l,virtualId:h,physicalId:h,sentEvents:[],isBackfilling:!1,backfillBuffer:[]}),this.virtualIdsByPhysicalId.set(h,h),this._subs[h]={tag:e,processFunc:s}})}emit(e,...t){if(B(e)){let s=!1;const n=[],o=H(e);return this._events=this._events.filter(l=>l.tag!==o||(setTimeout(()=>{l.listener.apply(this,t)},0),s=!0,!l.once||(n.push(l),!1))),n.forEach(l=>{this._stopEvent(l)}),s}return super.emit(e,...t)}sendBatch(e){return(0,c._)(this,void 0,void 0,function*(){let t=0;const s=e.map(({method:l,params:h})=>({method:l,params:h,jsonrpc:"2.0",id:"alchemy-sdk:"+t++})),n=yield this.sendBatchConcurrently(s),o=n.find(l=>!!l.error);if(o)throw new Error(o.error.message);return n.sort((l,h)=>l.id-h.id).map(l=>l.result)})}destroy(){return this.removeSocketListeners(),this.stopHeartbeatAndBackfill(),super.destroy()}isCommunityResource(){return this.apiKey===c.D}_stopEvent(e){let t=e.tag;if(W.includes(e.type)){if(this._events.filter(n=>W.includes(n.type)).length)return}else if("tx"===e.type){if(this._events.filter(n=>"tx"===n.type).length)return;t="tx"}else if(this.listenerCount(e.event))return;const s=this._subIds[t];!s||(delete this._subIds[t],s.then(n=>{!this._subs[n]||(delete this._subs[n],this.send("eth_unsubscribe",[n]))}))}addSocketListeners(){this._websocket.addEventListener("message",this.handleMessage),this._websocket.addEventListener("reopen",this.handleReopen),this._websocket.addEventListener("down",this.stopHeartbeatAndBackfill)}removeSocketListeners(){this._websocket.removeEventListener("message",this.handleMessage),this._websocket.removeEventListener("reopen",this.handleReopen),this._websocket.removeEventListener("down",this.stopHeartbeatAndBackfill)}resubscribeAndBackfill(e,t){return(0,c._)(this,void 0,void 0,function*(){const{virtualId:s,method:n,params:o,sentEvents:l,backfillBuffer:h,startingBlockNumber:f}=t;t.isBackfilling=!0,h.length=0;try{const p=yield this.send(n,o);switch(_(e),t.physicalId=p,this.virtualIdsByPhysicalId.set(p,s),o[0]){case"newHeads":{const k=yield te(()=>Y(this.backfiller.getNewHeadsBackfill(e,l,f),6e4),5,()=>!e());_(e),function de(r){return Q(r,e=>e.hash)}([...k,...h]).forEach(E=>this.emitNewHeadsEvent(s,E));break}case"logs":{const k=o[1]||{},g=yield te(()=>Y(this.backfiller.getLogsBackfill(e,k,l,f),6e4),5,()=>!e());_(e),function fe(r){return Q(r,e=>`${e.blockHash}/${e.logIndex}`)}([...g,...h]).forEach(T=>this.emitLogsEvent(s,T));break}}}finally{t.isBackfilling=!1,h.length=0}})}emitNewHeadsEvent(e,t){this.emitAndRememberEvent(e,t,M)}emitLogsEvent(e,t){this.emitAndRememberEvent(e,t,j)}emitAndRememberEvent(e,t,s){this.rememberEvent(e,t,s);const n=this.virtualSubscriptionsById.get(e);!n||this.emitGenericEvent(n,t)}rememberEvent(e,t,s){const n=this.virtualSubscriptionsById.get(e);!n||U(n.sentEvents,Object.assign({},t),s)}emitGenericEvent(e,t){this.emitProcessFn(e.event)(t)}startHeartbeat(){null==this.heartbeatIntervalId&&(this.heartbeatIntervalId=setInterval(()=>(0,c._)(this,void 0,void 0,function*(){try{yield Y(this.send("net_version"),1e4)}catch{this._websocket.reconnect()}}),3e4))}sendBatchConcurrently(e){return(0,c._)(this,void 0,void 0,function*(){return Promise.all(e.map(t=>this.send(t.method,t.params)))})}customStartEvent(e){if(e.type===L){const{fromAddress:t,toAddress:s,hashesOnly:n}=e;this._subscribe(e.tag,[c.A.PENDING_TRANSACTIONS,{fromAddress:t,toAddress:s,hashesOnly:n}],this.emitProcessFn(e),e)}else if(e.type===x){const{addresses:t,includeRemoved:s,hashesOnly:n}=e;this._subscribe(e.tag,[c.A.MINED_TRANSACTIONS,{addresses:t,includeRemoved:s,hashesOnly:n}],this.emitProcessFn(e),e)}else"block"===e.type?this._subscribe("block",["newHeads"],this.emitProcessFn(e),e):"filter"===e.type&&this._subscribe(e.tag,["logs",this._getFilter(e.filter)],this.emitProcessFn(e),e)}emitProcessFn(e){switch(e.type){case L:return t=>this.emit({method:c.A.PENDING_TRANSACTIONS,fromAddress:e.fromAddress,toAddress:e.toAddress,hashesOnly:e.hashesOnly},t);case x:return t=>this.emit({method:c.A.MINED_TRANSACTIONS,addresses:e.addresses,includeRemoved:e.includeRemoved,hashesOnly:e.hashesOnly},t);case"block":return t=>{const s=O.O$.from(t.number).toNumber();this._emitted.block=s,this.emit("block",s)};case"filter":return t=>{null==t.removed&&(t.removed=!1),this.emit(e.filter,this.formatter.filterLog(t))};default:throw new Error("Invalid event type to `emitProcessFn()`")}}_off(e,t){if(null==t)return this.removeAllListeners(e);const s=[];let n=!1;const o=H(e);return this._events=this._events.filter(l=>!(l.tag===o&&l.listener==t&&!n&&(n=!0,s.push(l),1))),s.forEach(l=>{this._stopEvent(l)}),this}_removeAllListeners(e){let t=[];if(null==e)t=this._events,this._events=[];else{const s=H(e);this._events=this._events.filter(n=>n.tag!==s||(t.push(n),!1))}return t.forEach(s=>{this._stopEvent(s)}),this}_listenerCount(e){if(!e)return this._events.length;const t=H(e);return this._events.filter(s=>s.tag===t).length}_listeners(e){if(null==e)return this._events.map(s=>s.listener);const t=H(e);return this._events.filter(s=>s.tag===t).map(s=>s.listener)}}function te(r,e,t=(()=>!0)){return(0,c._)(this,void 0,void 0,function*(){let s=0,n=0;for(;;)try{return yield r()}catch(o){if(n++,n>=e||!t(o)||(yield Ne(s),!t(o)))throw o;s=0===s?1e3:Math.min(3e4,2*s)}})}function Ne(r){return new Promise(e=>setTimeout(e,r))}function Y(r,e){return Promise.race([r,new Promise((t,s)=>setTimeout(()=>s(new Error("Timeout")),e))])}function M(r){return(0,c.f)(r.number)}function j(r){return(0,c.f)(r.blockNumber)}function U(r,e,t){const s=t(e),n=r.findIndex(o=>t(o)>s-10);-1===n?r.length=0:r.splice(0,n),r.push(e)}},8878:I=>{var A=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};I.exports=function(){if(this)return this;if("object"==typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return A()}try{return __global__||A()}finally{delete Object.prototype.__global__}}()},3488:(I,A)=>{"use strict";var O=function(){function a(i,u,d){if(void 0===d&&(d={}),this.url=i,this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this.ondown=null,this.onreopen=null,this.CONNECTING=a.CONNECTING,this.OPEN=a.OPEN,this.CLOSING=a.CLOSING,this.CLOSED=a.CLOSED,this.hasBeenOpened=!1,this.isClosed=!1,this.messageBuffer=[],this.nextRetryTime=0,this.reconnectCount=0,this.lastKnownExtensions="",this.lastKnownProtocol="",this.listeners={},null==u||"string"==typeof u||Array.isArray(u)?this.protocols=u:d=u,this.options=function R(a){var i={};return Object.keys(O.DEFAULT_OPTIONS).forEach(function(u){var d=a[u];i[u]=void 0===d?O.DEFAULT_OPTIONS[u]:d}),i}(d),!this.options.wsConstructor){if(!(typeof WebSocket<"u"))throw new Error("WebSocket not present in global scope and no wsConstructor option was provided.");this.options.wsConstructor=WebSocket}this.openNewWebSocket()}return Object.defineProperty(a.prototype,"binaryType",{get:function(){return this.binaryTypeInternal||"blob"},set:function(i){this.binaryTypeInternal=i,this.ws&&(this.ws.binaryType=i)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bufferedAmount",{get:function(){var i=this.ws?this.ws.bufferedAmount:0,u=!1;return this.messageBuffer.forEach(function(d){var w=function y(a){return"string"==typeof a?2*a.length:a instanceof ArrayBuffer?a.byteLength:a instanceof Blob?a.size:void 0}(d);null!=w?i+=w:u=!0}),u&&this.debugLog("Some buffered data had unknown length. bufferedAmount() return value may be below the correct amount."),i},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"extensions",{get:function(){return this.ws?this.ws.extensions:this.lastKnownExtensions},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"protocol",{get:function(){return this.ws?this.ws.protocol:this.lastKnownProtocol},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"readyState",{get:function(){return this.isClosed?a.CLOSED:a.OPEN},enumerable:!0,configurable:!0}),a.prototype.close=function(i,u){this.disposeSocket(i,u),this.shutdown(),this.debugLog("WebSocket permanently closed by client.")},a.prototype.send=function(i){if(this.isClosed)throw new Error("WebSocket is already in CLOSING or CLOSED state.");this.ws&&this.ws.readyState===this.OPEN?this.ws.send(i):this.messageBuffer.push(i)},a.prototype.reconnect=function(){if(this.isClosed)throw new Error("Cannot call reconnect() on socket which is permanently closed.");this.disposeSocket(1e3,"Client requested reconnect."),this.handleClose(void 0)},a.prototype.addEventListener=function(i,u){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(u)},a.prototype.dispatchEvent=function(i){return this.dispatchEventOfType(i.type,i)},a.prototype.removeEventListener=function(i,u){this.listeners[i]&&(this.listeners[i]=this.listeners[i].filter(function(d){return d!==u}))},a.prototype.openNewWebSocket=function(){var i=this;if(!this.isClosed){var u=this.options,d=u.connectTimeout,w=u.wsConstructor;this.debugLog("Opening new WebSocket to "+this.url+".");var N=new w(this.url,this.protocols);N.onclose=function(m){return i.handleClose(m)},N.onerror=function(m){return i.handleError(m)},N.onmessage=function(m){return i.handleMessage(m)},N.onopen=function(m){return i.handleOpen(m)},this.connectTimeoutId=setTimeout(function(){i.clearConnectTimeout(),i.disposeSocket(),i.handleClose(void 0)},d),this.ws=N}},a.prototype.handleOpen=function(i){var u=this;if(this.ws&&!this.isClosed){var d=this.options.allClearResetTime;this.debugLog("WebSocket opened."),null!=this.binaryTypeInternal?this.ws.binaryType=this.binaryTypeInternal:this.binaryTypeInternal=this.ws.binaryType,this.clearConnectTimeout(),this.hasBeenOpened?this.dispatchEventOfType("reopen",i):(this.dispatchEventOfType("open",i),this.hasBeenOpened=!0),this.messageBuffer.forEach(function(w){return u.send(w)}),this.messageBuffer=[],this.allClearTimeoutId=setTimeout(function(){u.clearAllClearTimeout(),u.nextRetryTime=0,u.reconnectCount=0,u.debugLog("WebSocket remained open for "+(d/1e3|0)+" seconds. Resetting retry time and count.")},d)}},a.prototype.handleMessage=function(i){this.isClosed||this.dispatchEventOfType("message",i)},a.prototype.handleClose=function(i){var u=this;if(!this.isClosed){var d=this.options,w=d.maxReconnectAttempts,N=d.shouldReconnect;if(this.clearConnectTimeout(),this.clearAllClearTimeout(),this.ws&&(this.lastKnownExtensions=this.ws.extensions,this.lastKnownProtocol=this.ws.protocol,this.disposeSocket()),this.dispatchEventOfType("down",i),this.reconnectCount>=w)return void this.stopReconnecting(i,this.getTooManyFailedReconnectsMessage());var m=!i||N(i);"boolean"==typeof m?this.handleWillReconnect(m,i,"Provided shouldReconnect() returned false. Closing permanently."):m.then(function(F){u.isClosed||u.handleWillReconnect(F,i,"Provided shouldReconnect() resolved to false. Closing permanently.")})}},a.prototype.handleError=function(i){this.dispatchEventOfType("error",i),this.debugLog("WebSocket encountered an error.")},a.prototype.handleWillReconnect=function(i,u,d){i?this.reestablishConnection():this.stopReconnecting(u,d)},a.prototype.reestablishConnection=function(){var i=this,u=this.options,d=u.minReconnectDelay,w=u.maxReconnectDelay,N=u.reconnectBackoffFactor;this.reconnectCount++;var m=this.nextRetryTime;this.nextRetryTime=Math.max(d,Math.min(this.nextRetryTime*N,w)),setTimeout(function(){return i.openNewWebSocket()},m),this.debugLog("WebSocket was closed. Re-opening in "+(m/1e3|0)+" seconds.")},a.prototype.stopReconnecting=function(i,u){this.debugLog(u),this.shutdown(),i&&this.dispatchEventOfType("close",i)},a.prototype.shutdown=function(){this.isClosed=!0,this.clearAllTimeouts(),this.messageBuffer=[],this.disposeSocket()},a.prototype.disposeSocket=function(i,u){!this.ws||(this.ws.onerror=v,this.ws.onclose=v,this.ws.onmessage=v,this.ws.onopen=v,this.ws.close(i,u),this.ws=void 0)},a.prototype.clearAllTimeouts=function(){this.clearConnectTimeout(),this.clearAllClearTimeout()},a.prototype.clearConnectTimeout=function(){null!=this.connectTimeoutId&&(clearTimeout(this.connectTimeoutId),this.connectTimeoutId=void 0)},a.prototype.clearAllClearTimeout=function(){null!=this.allClearTimeoutId&&(clearTimeout(this.allClearTimeoutId),this.allClearTimeoutId=void 0)},a.prototype.dispatchEventOfType=function(i,u){var d=this;switch(i){case"close":this.onclose&&this.onclose(u);break;case"error":this.onerror&&this.onerror(u);break;case"message":this.onmessage&&this.onmessage(u);break;case"open":this.onopen&&this.onopen(u);break;case"down":this.ondown&&this.ondown(u);break;case"reopen":this.onreopen&&this.onreopen(u)}return i in this.listeners&&this.listeners[i].slice().forEach(function(w){return d.callListener(w,u)}),!u||!u.defaultPrevented},a.prototype.callListener=function(i,u){"function"==typeof i?i.call(this,u):i.handleEvent.call(this,u)},a.prototype.debugLog=function(i){this.options.debug&&console.log(i)},a.prototype.getTooManyFailedReconnectsMessage=function(){var i=this.options.maxReconnectAttempts;return"Failed to reconnect after "+i+" "+function P(a,i){return 1===i?a:a+"s"}("attempt",i)+". Closing permanently."},a.DEFAULT_OPTIONS={allClearResetTime:5e3,connectTimeout:5e3,debug:!1,minReconnectDelay:1e3,maxReconnectDelay:3e4,maxReconnectAttempts:Number.POSITIVE_INFINITY,reconnectBackoffFactor:1.5,shouldReconnect:function(){return!0},wsConstructor:void 0},a.CONNECTING=0,a.OPEN=1,a.CLOSING=2,a.CLOSED=3,a}();function v(){}A.Z=O},2762:(I,A,b)=>{var c;if("object"==typeof globalThis)c=globalThis;else try{c=b(8878)}catch{}finally{if(!c&&typeof window<"u"&&(c=window),!c)throw new Error("Could not determine global this")}var S=c.WebSocket||c.MozWebSocket,O=b(3386);function R(y,P){return P?new S(y,P):new S(y)}S&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(y){Object.defineProperty(R,y,{get:function(){return S[y]}})}),I.exports={w3cwebsocket:S?R:null,version:O}},3386:(I,A,b)=>{I.exports=b(9794).version},9794:I=>{"use strict";I.exports={version:"1.0.34"}}}]);